# README

## 概要

このスクリプトは、指定されたディレクトリ内の学生のC++プログラムを自動的にフォーマット、コンパイル、実行するためのものです。`config.ini`ファイルに記載された学生番号のリストに基づいて処理を行います。

## 前提条件
- **clang-format**：コードの自動フォーマットに使用します。
- **g++**：C++コードのコンパイルに使用します。
- **config.iniファイル**：学生番号のリストを含む設定ファイル。

## 環境構築
* Max
    ```bash 
    brew install gcc clang-format
    ```
* Linux
    ```bash
    sudo apt install g++ clang-format
    ```
## 動作確認
* 実行権限付与 `chmod +x ./compile.sh`
* プロジェクトのルートで `./compile.sh ./example`
    ```bash
    .
    ├── REMDME.md
    ├── compile.sh
    ├── config.ini
    └── example
        ├── 00000000.cpp
        ├── 12345677.cpp
        ├── 12345678.cpp
        └── 12345679.cpp
    ```

## 設定ファイル (`config.ini`)

`config.ini`ファイルは、以下の形式で学生番号のリストを指定します。

```
[DEFAULT]
StudentList = [12345677, 12345678, 12345679]
```

- `StudentList`：処理対象の学生番号をカンマ区切りで指定します。リストは角括弧 `[` と `]` で囲んでください。

## 使用方法

1. スクリプトと同じディレクトリに`config.ini`ファイルを配置します。

2. ターミナルでスクリプトを実行します。

   ```
   ./script.sh target_dir
   ```

   - `script.sh`：このスクリプトのファイル名。
   - `target_dir`：学生のC++ファイルが格納されているディレクトリへのパス。

## スクリプトの動作

- **設定ファイルの確認**：`config.ini`が存在するか確認します。

- **引数の確認**：`target_dir`が指定されているか確認します。

- **ディレクトリの確認**：`target_dir`が存在し、ディレクトリであることを確認します。

- **学生番号の取得**：`config.ini`から`StudentList`を読み込み、学生番号の配列を作成します。

- **ループ処理**：各学生番号について以下を行います。

  1. **ファイルの存在確認**：`target_dir`内に対応する`学生番号.cpp`ファイルが存在するか確認します。

  2. **コードのフォーマット**：`clang-format`を使用してC++コードをフォーマットします。

  3. **コンパイル**：`g++`でC++コードをコンパイルし、実行ファイルを作成します。

  4. **実行**：コンパイルされた実行ファイルを実行します。

  5. **後処理**：実行が成功した場合、実行ファイルを削除します。失敗した場合は実行ファイルを残します。

## 注意事項

- **ファイル名の規則**：学生のC++ファイルは`学生番号.cpp`という名前である必要があります。

- **フォーマットの適用**：`clang-format`は標準出力にフォーマット済みコードを出力します。元のファイルを上書きしたい場合は、スクリプト内の`clang-format`コマンドに`-i`オプションを追加してください。

- **エラーハンドリング**：各ステップでエラーが発生した場合、適切なメッセージを表示し、次の学生番号の処理に進みます。

## エラーメッセージ一覧

- `Error: config.ini が見つかりません。`：設定ファイルが存在しません。

- `使用法: ./script.sh target_dir`：引数が正しくありません。

- `Error: 'target_dir' は存在しないか、ディレクトリではありません。`：指定されたディレクトリが無効です。

- `Error: config.ini に StudentList が見つかりません。`：`StudentList`の定義がありません。

- `Warning: ファイルが見つからないため、スキップします。`：指定された学生のC++ファイルが存在しません。

- `Error: コンパイルに失敗しました。`：C++コードのコンパイルに失敗しました。

- `Error: 実行に失敗しました。削除しません。`：実行ファイルの実行に失敗しました。
